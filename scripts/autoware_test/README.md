# Autoware Test Scripts

This directory contains scripts for testing `dump_launch` and `play_launch` with Autoware.

## Setup

1. **Create the autoware symlink** pointing to your Autoware workspace:
   ```bash
   ln -s /path/to/your/autoware autoware
   ```

   The symlink should point to a built Autoware workspace containing `install/setup.bash`.

2. **Ensure you have the required map data**:
   ```bash
   # The script expects the sample map at:
   $HOME/autoware_map/sample-map-planning
   ```

## Usage

Run the test script:
```bash
./run.sh
```

This will:
1. Validate the `autoware` symlink
2. Source the Autoware environment
3. Run `dump_launch` to capture the Autoware planning_simulator launch
4. Run `play_launch` to replay the captured launch with:
   - Container service readiness checking enabled
   - 300 second timeout for container services
   - 60 second timeout for composable node loading

## Files

- `run.sh` - Main test script
- `autoware` - Symlink to Autoware installation (you must create this)
- `record.json` - Generated by `dump_launch` (contains launch execution record)
- `play_log/` - Generated by `play_launch` (contains timestamped execution logs)

## Troubleshooting

### Error: 'autoware' symlink not found
Create the symlink:
```bash
ln -s /path/to/autoware autoware
```

### Error: symlink points to non-existent directory
Update the symlink to point to a valid Autoware installation:
```bash
ln -sf /path/to/autoware autoware
```

### Error: Autoware installation appears to be incomplete
Ensure the symlink points to a built Autoware workspace that contains `install/setup.bash`:
```bash
ls -la autoware/install/setup.bash
```

## play_launch Flags

The script uses these flags for Autoware testing:

- `--wait-for-service-ready` - Enable container service readiness checking via ROS service discovery
- `--service-ready-timeout-secs 300` - Wait up to 5 minutes for each container service to be ready
- `--load-node-timeout-millis 60000` - Wait up to 60 seconds for each composable node to load

These conservative timeouts are appropriate for Autoware's large number of containers and composable nodes, where DDS initialization can take significant time.
